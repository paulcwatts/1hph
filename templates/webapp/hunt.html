{% extends "base_title.html" %}
{% block head %}
<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/blueprint/buttons/screen.css"/>
<link rel="alternate" type="application/json" href="{% url api-hunt hunt.slug %}"/>
<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery.form.js"></script>
{% endblock %}
{% block title-thumb-src %}{{ hunt.get_thumbnail_url }}{% endblock %}
{% block title-line1 %}Hunt: <span class="phrase">{{ hunt.phrase }}</span>{% endblock %}
{% block title-line2 %}Some other info{% endblock %}
{% block page-content %}
{% comment %}
 A hunt can be in four states: FUTURE, CURRENT, VOTING, FINISHED
 By default, all items that match $(".state-obj") will be hidden

 Once we download the JSON and determine that which state we are in,
 we'll show all items that match $(".state-(statename)").
{% endcomment %}
<div class="span-9 colborder">
  <div class="vote-box">
    <button id="vote-button" type="submit" class="vote-button button positive">
      <img src="{{ MEDIA_URL }}css/blueprint/buttons/icons/photos.png" alt=""/>
      Click here to start voting!
    </button>
    <hr/>
  </div>
  <div class="submit-box">
    <h3>Submit a photo</h3>
    {% if submit_form.is_multipart %}
    <form id="upload" method="POST" action="{% url api-photo-index hunt.slug %}" enctype="multipart/form-data">
    {% else %}
    <form id="upload" method="POST" action="{% url api-photo-index hunt.slug %}">
    {% endif %}
    <table cellspacing="0">
       <tr>
         <td>{{ submit_form.photo.label_tag }}</td>
         <td>{{ submit_form.photo }}</td>
       </tr>
       <tr>
         <td></td>
         <td>{{ submit_form.valid_check }} By checking this box, you agree to <a href="/help/tos/">follow the rules</a>.</td>
       </tr>
       <tr>
         <td></td>
         <td>
           {% csrf_token %}
           <input type="hidden" name="via" value="Web"/>
           <input type="submit" value="Submit"/>
         </td>
    </table>
    </form>
    <hr/>
  </div>
  <div>
    {% url api-hunt-comment-index hunt.slug as comments_url %}
    {% url hunt-comments hunt.slug as show_all_url %}
    {% include "includes/comments.html" %}
  </div>
</div>
<div class="span-5 last">
    {% with hunt.submission_set.all|length as count %}
      <div class="num-submissions counter center-text">{{ count }}</div>
      <div class="center-text hint-color">submission{{ count|pluralize }}</div>
    {% endwith %}
    <hr/>
     {% url api-photo-index hunt.slug as submissions_url %}
     {% url photo-index hunt.slug as show_all_url %}
     {% with "Recent Submissions" as submissions_title %}
         {% include "includes/submissions.html" %}
     {% endwith %}
</div>


<script type="text/javascript">
var huntURL = null;
var huntObj = null;

$(function() {
  huntURL = $("link[type='application/json']").attr("href");
  $.getJSON(huntURL, function(data) {
    huntObj = data;
  });
})
</script>

{% endblock %}
